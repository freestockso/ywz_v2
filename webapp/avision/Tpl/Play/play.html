<!--
    播放器主页面，结构：

    通过ThinkPHP传入的页面变量：

-->
<!--<link rel="stylesheet" href="https://g.alicdn.com/de/prismplayer/2.8.7/skins/default/aliplayer-min.css" />-->
<link rel="stylesheet" href="__PUBLIC__/aliplayer/aliplayer2.8.7.css" />
<link href="__PUBLIC__/kindeditor/article.css" rel="stylesheet" >
<style>
    .fullScreen{
        position: absolute;
        top:0;
        width: 100vw; height: 100vh;
    }

    .layerCover{  z-index: 90;  }   /*  频道封面层 */
    .layerCoverBtn{  z-index: 91;  }
    .layerPopup{ z-index: 51; }     /* 弹出窗口层 */
    .layerForce { z-index: 50; }    /* 频道强制操作层, 同时作为marsk层 */
    /* 阿里视频窗口的z-index=11 */
    .layerVideoTop1 { z-index: 21; } /* 视频窗口之上的显示层1，显示固定于视频之上的内容 */
    .layerVideoTop2 { z-index: 20; } /* 视频窗口之上的显示层2，视频开始播放后不显示 */
    .layerMain { z-index: 0; }  /* 频道主显示层 */
    .btnCircle{
        border-radius: 50%;
    }
    #blkCover{
        background-color: #ff3;
        overflow-y: auto;
    }
    #blkForceLayer{
        display:none;
        background-color: rgba(120,120,120,.6); color: #fff;">
    }

    /****视频播放窗口相关样式****/
    video {
        /* width:100%;
        object-position: 0 50% !important;
        object-fit: contain !important; */
        object-position: center top !important;
    }
    video::-webkit-media-controls {
        position: absolute;
        bottom: 0;
    }

    /**	 中部导航栏的样式定义  */
    .func-tabs{
        /* 导航条容器 */
        position: relative;
        box-sizing: border-box;
        white-space: nowrap;
        overflow: hidden;
        padding-top:2px;
        /*margin: 4px 0;	 拉开距离是为了显示阴影效果*/
        box-shadow: inset 0 0px 3px 0px #aab;
        border: 0;
        width: 100%;
        font-size: 13px;
        color: #3a3a3a;
        line-height: 24px;
        background-color: #fcfdfe;
        height: 30px;
    }
    .tab-list{
        display:inline-flex;
        /* width: calc(100% - 37px); 有more菜单 */
        width: calc(100% - 1px);
        flex-flow:row nowrap;
        white-space: nowrap;
        justify-content:space-around;
        overflow-x: scroll;
    }
    .more-menu{
        display: inline-block;
        width: 36px;
        text-align: center;
        border-left: 1px solid #eee;
        border-bottom: 1px solid #f1f2f3;
    }
    .tab-list div{
        flex-grow: 1;
        padding: 0 0.6em;
        text-align: center;
    }
    .tab-list .tab-selected{
        border-bottom: 2px solid #02aaf1;
        color:#028ae1;
    }

    .tabContiner{
        display:inline-block;position:relative;
        vertical-align: top;
        width: 100%;height: 100%;
        overflow-x: hidden;
        overflow-y: auto;
    }

</style>

<!-- 频道封面层，初始化时通过 $showCover 变量控制是否显示 -->
<div id="blkCover" class="fullScreen layerCover article">
    {$coverHtml}
    <div id="btnEnterChannel" class="layerCoverBtn btnCircle" style="position: fixed; top:2em; right: 2em; width:4em; padding:1em;height:4em;display: flex;/*设置外层盒子display为flex*/
            justify-content:center;/*设置内层盒子的水平居中*/
            align-items:center;/*设置内层盒子的垂直居中*/
            background-color: rgba(30,30,30,.3); color: #fff;">
        <div style="position: relative;z-index: 99;">进入频道</div>
    </div>
</div>

<!-- 强制操作层 按$forceLayer指示执行不同的操作 -->
<div id="blkForceLayer" class="fullScreen layerForce" style="">
    {$forceLayerHtml}
</div>

<!-- 播放器层 -->
<div id="blkMain" class="fullScreen layerMain" style="display: flex; flex-flow:column nowrap;justify-content:flex-start; overflow: hidden;">
    <!-- 视频窗口 -->
    <div  class="blk_video"  style="position: relative;width:100%; height:0;padding-top: 56.25%; flex:none; overflow: hidden;">
        <div  class="prism-player" id="prismPlayer" style="position: absolute;width:100%; height:100%; top:0;"></div>
        <!-- 视频叠加层 1-->
        <div class="layerVideoTop1" style="display:none;position: absolute; top:0;width: 100%; height: 100%;">
            <div class="blk_heat" style="position: absolute; bottom:10px; left:10px; line-height: 14px; font-size: 14px;">
                <img src="__PUBLIC__/images/fire32.png" style="height: 16px; vertical-align: middle;">
                <span style="display: inline-block; padding: 2px 5px; background-color: rgba(255,255,255, .4); border-radius: 8px;">{$entrytimes}</span>
            </div>
            <div class="blk_my" style="position: absolute; top:10px; right: 15px;">
                <img src="__PUBLIC__/images/my_white.png" style="height: 20px;">
            </div>
        </div>
        <!-- 视频叠加层 2-->
        <div class="layerVideoTop2" style="position: absolute; top:0; width: 100%; height: 100%; ">
            <div class="blk_airTime" style="position: absolute; bottom: 70px; right: 10px; font-size: 16px; color:#fff; background-color: rgba(100,100,120,.3);"></div>
            <div class="blk_leftTime" style="position: absolute; bottom: 40px; right: 10px; font-size: 16px; color:#fff; background-color: rgba(100,100,120,.3);"></div>
        </div>
    </div>
    <!-- 中部导航条 -->
    <div class="func-tabs" style="flex:none;">
        <div id="tabBar" class="tab-list">
            <assign name="tabOrder" value="0" />
            <foreach name="tabs" key="tabid" item="tabtext">
                <div tabid="{$tabid}" tabOrder="{$tabOrder++}">{$tabtext}</div>
            </foreach>
        </div>
    </div>
    <!--<button  style="z-index:999; position: fixed; bottom:100px;" onclick="playPage.send({},function(){ alert('send callback');})">send data</button>-->
    <!-- 下部多功能窗口 -->
    <div id="blkSouth" style="position: relative; width: 100%; height:200px; background-color: #FFF; flex: auto; overflow-x: auto;overflow-y:hidden;white-space: nowrap;">
        <foreach name="tabs" key="tabid" item="tabtext">
            <div class="tabContiner" id="tabItem{$tabid}" >
                <div style="position: relative; margin: 30% auto; text-align: center">
                    <img src="Public/images/loading.gif" style="width: 128px;">
                    <div>{$tabtext} loading...</div>
                </div>

            </div>
        </foreach>
    </div>

    <!-- 图文直播容器-->
    <div id="pictxt" style="position: relative; bottom:0; height:100%; width:100%;  background-color: #FFF;display:none; overflow-x: hidden; overflow-y: auto; white-space: normal;">Loading...</div>

    <!-- 弹出窗口，放在这里是为了避免，非同层播放时被视频遮挡 -->
    <div id="win_popup" class="layerPopup" style="position: fixed; display:none; top:65vw; left:0; right:0; margin: 0 auto; width: 96%; min-height: 57vw;
        box-shadow: 0 0 3px 1px #999 inset; border-radius:14px; background-color: #feffff; padding: 15px; text-align: center;">
        <div class="win_notify" style="margin-top: 16px; font-size: 18px; color: #444;"> </div>
        <div class="blk_button" style="position: absolute; width: 95%; bottom: 30px; text-align:center; ">
            <button style="border-radius:5px; padding:2px 15px; font-size:16px;">确定</button>
        </div>
    </div>

</div>
<!--<script charset="utf-8" type="text/javascript" src="__PUBLIC__/aliplayer/aliplayer2.8.7-h5-min.js" ></script>-->
<!--<script charset="utf-8" type="text/javascript" src="https://g.alicdn.com/de/prismplayer/2.8.7/aliplayer-h5-min.js" ></script>-->
<load href="__PUBLIC__/js/publicFunction.js" />
<!--<load href="__ROOT__/player/js/playpage3.1.min.js" />-->
<load href="__ROOT__/player/js/playpage.js" />
<script>
    //本页面的全局JS对象，外部可通过此对象访问开放bridge接口，实现与对象内部的通讯
    var playPage = new Ou_playPage({
        showCover: "{$showCover}" == "1" ? true : false,    //是否显示频道封面
        chnid: "{$chnid}",   //当前频道ID
        vodid: "{$vodid}",   //需要播放的VOD文件ID
        uid: "{$uid}",       //当前用户ID
        agent: "{$agent}",
        playType: "{$playType}", //播放类型 [live|vod]
        activetab: "{$activetab}",   //默认活跃的tabID
        source: "{$source}",     //要播放的视频源
        //source: "http://v2.av365.cn/live/ou.m3u8",     //要播放的视频源
        cover: "{$cover}",       //视频区封面图片
        forceLayer: "{$forceLayer}", //强制操作层显示内容
        onlineid: "{$onlineid}",     //本web页面的onlineid，在线表中另有副本
        playToken: "{$playToken}",   //有权播放令牌
        aliveTime: "{$aliveTime}",    //最长通讯时间间隔(秒)
        operatorIdleInt: "{$operatorIdleInt}",   //播放终端最长不操作时间(秒)
        homeUrl: "{$homeUrl}",       //首页地址
        airTime: "{$airTime}",       //开始直播时间
        airDuration: "{$airDuration}",   //播出时长
        isAdmin: "{$isAdmin}",       //是否特权用户
        title: "{$title}",       //页面标题
        desc: "{$desc}",     //频道或点播视频的说明
        appUrl: "__APP__",       //应用基本地址
        tabItemPrefix: "tabItem"     //多功能窗口内各tab容器子窗口的id前缀
    });

</script>